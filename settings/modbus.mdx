---
title: "Modbus"
description: "Configuração da comunicação via modbus"
---

### Settings.json

```json
  "modbus": {
    "host": "127.0.0.1",
    "port": 502,
    "slaveId": 1,
    "heartbeatInterval": 10,
    "heartbeatAddress": 1,
    "pieceStartTriggerAddress": 2,
    "pieceTriggerDebounce": 100,
    "pieceResult": {
      "resultAddress": 3,
      "updateAddress": 4
    },
    "processResult": {
      "Processor": {
        "resultAddress": 5,
        "updateAddress": 6
      }
    }
  },
```

O framework pode se comunicar com um dispositivo de automação via protocolo modbus, atuando como  **cliente **modbus. Os **endereços modbus começam em 1**, e **todas as variaveis são escritas em memória coil**.

A configuração da comunicação modbus é feita no arquivo de configuração pelo campo **modbus**:

- **host**
  - IP do dispositivo **servidor**.
- **port**
  - Porta tcp do dispositivo **servidor**.
- **slaveId**
  - Id do cliente conectado.
- **heartbeatInterval**
  - Intervalo do [heartbeat](/settings/heartbeat).
- **heartbeatAddress**
  - Endereço modbus no servidor para escrever o [heartbeat](/settings/heartbeat).
- **pieceResult**
  - Endereços usados para escrever o resultado **geral** da peça processada.
  - **resultAddress**
    - Endereço modbus onde o resultado será escrito, sendo verdadeiro apenas caso aprove.
  - **updateAddress**
    - Endereço modbus onde será escrito verdadeiro para indicar que o resultado foi escrito no resultAddress, o dispositivo deve consumir esse dado para garantir o sincronismo dos sistemas.
- **processResult**
  - Endereços usados para escrever o resultado **especifico** de cada processamento. Para habilitar, é necessario adicionar na configuração, dentro do **processResult**, uma entrada com o nome do processor que se deseja escrever o resultado, com as propriedades resultAddress e updateAddress. Exemplo, para escrever os resultados do processamento **_"Processor"_**, basta adicionar em process result da seguinte forma:

    ```json
    "processResult": {
       "Processor": {
          "resultAddress": 5,
          "updateAddress": 6
       }
    }
    ```
  - **resultAddress**
    - Endereço modbus onde o resultado será escrito, sendo verdadeiro apenas caso aprove.
  - **updateAddress**
    - Endereço modbus onde será escrito verdadeiro para indicar que o resultado foi escrito no resultAddress, o dispositivo deve consumir esse dado para garantir o sincronismo dos sistemas.